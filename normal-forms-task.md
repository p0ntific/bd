# Нарушения НФ и нормализация отношений

## 1. Таблица "Книги"

**ТАБЛИЦА:**
Книги (Название_книги, Автор, Страна_проживания_автора, Название_библиотеки)

**НАРУШЕНИЕ НФ:**
3НФ

**ПРИЧИНА:**
Транзитивная зависимость: страна автора зависит от автора, а не от книги

**ПОЯСНЕНИЕ:**
"Страна_проживания_автора" определяется "Автором", а не ключом записи о книге. Получается цепочка: Книга → Автор → Страна. Это транзитивная зависимость и нарушение 3НФ.

**НОРМАЛИЗАЦИЯ:**
- Книги (ID_книги, Название_книги, ID_автора, ID_библиотеки)
- Авторы (ID_автора, Имя_автора, ID_страны)
- Страны (ID_страны, Название_страны)
- Библиотеки (ID_библиотеки, Название_библиотеки)

---

## 2. Таблица "Заказы" (интернет-магазин)

**ТАБЛИЦА:**
Заказы (Номер_заказа, Название_товара, Количество_товара, Имя_клиента, Адрес_клиента)

**НАРУШЕНИЕ НФ:**
1НФ и 2НФ

**ПРИЧИНА:**
В одном заказе несколько товаров; данные клиента зависят не от всего составного ключа

**ПОЯСНЕНИЕ:**
- 1НФ нарушена: один заказ содержит много товаров — появляются повторяющиеся группы/списки в ячейках.
- 2НФ нарушена: при ключе (Номер_заказа, Название_товара) поля "Имя_клиента" и "Адрес_клиента" зависят только от Номер_заказа, а не от всего ключа.

**НОРМАЛИЗАЦИЯ:**
- Заказы (Номер_заказа, ID_клиента, Дата_заказа)
- Состав_заказа (Номер_заказа, ID_товара, Количество)
- Товары (ID_товара, Название_товара, Цена)
- Клиенты (ID_клиента, Имя_клиента, Адрес_клиента)

---

## 3. Таблица "Клиенты"

**ТАБЛИЦА:**
Клиенты (ID_клиента, Имя_клиента, Регион_клиента, Город_клиента, Почтовый_индекс)

**НАРУШЕНИЕ НФ:**
3НФ

**ПРИЧИНА:**
Транзитивные зависимости: и регион, и индекс определяются городом

**ПОЯСНЕНИЕ:**
"Регион_клиента" и "Почтовый_индекс" зависят от "Город_клиента", а не напрямую от ключа клиента. Цепочка: Клиент → Город → Регион/Индекс. Это избыточность и нарушение 3НФ.

**НОРМАЛИЗАЦИЯ:**
- Клиенты (ID_клиента, Имя_клиента, ID_города)
- Города (ID_города, Название_города, Почтовый_индекс, ID_региона)
- Регионы (ID_региона, Название_региона)

---

## 4. Таблица "Заказы" (с НДС)

**ТАБЛИЦА:**
Заказы (Номер_заказа, Цена_без_НДС, НДС)

**НАРУШЕНИЕ НФ:**
3НФ

**ПРИЧИНА:**
"НДС" — производное значение

**ПОЯСНЕНИЕ:**
Если НДС считается как Цена_без_НДС × Ставка_НДС, хранить его не нужно: это дублирование и риск несогласованности при изменении цены или ставки.

**НОРМАЛИЗАЦИЯ:**
- Заказы (Номер_заказа, Цена_без_НДС, Ставка_НДС)

Примечание: сумму НДС лучше считать в запросе:
SELECT Номер_заказа, Цена_без_НДС, (Цена_без_НДС * Ставка_НДС) AS Сумма_НДС

---

## 5. Таблица "Проект"

**ТАБЛИЦА:**
Проект (ID_проекта, Направление, Куратор)

**НАРУШЕНИЕ НФ:**
3НФ

**ПРИЧИНА:**
Направление определяется куратором, а не проектом

**ПОЯСНЕНИЕ:**
Если у каждого куратора ровно одно направление, то "Направление" зависит от "Куратор". Цепочка: Проект → Куратор → Направление. Это транзитивная зависимость.

**НОРМАЛИЗАЦИЯ:**
- Проекты (ID_проекта, Название_проекта, ID_куратора)
- Кураторы (ID_куратора, ФИО_куратора, ID_направления)
- Направления (ID_направления, Название_направления)

---

## 6. Таблица "Студент"

**ТАБЛИЦА:**
Студент (ID_студента, Посещаемый_курс, Хобби)

**НАРУШЕНИЕ НФ:**
1НФ

**ПРИЧИНА:**
В полях — множества значений (несколько курсов и хобби)

**ПОЯСНЕНИЕ:**
У студента может быть несколько курсов и несколько хобби. Хранение списков в одной ячейке нарушает требование атомарности 1НФ.

**НОРМАЛИЗАЦИЯ:**
- Студенты (ID_студента, Имя_студента, Группа)
- Курсы (ID_курса, Название_курса)
- Студент_Курс (ID_студента, ID_курса) — связь многие-ко-многим
- Хобби (ID_хобби, Название_хобби)
- Студент_Хобби (ID_студента, ID_хобби) — связь многие-ко-многим

---

## 7. Таблица "Сотрудник-Проект"

**ТАБЛИЦА:**
(Сотрудник, Проект, Вид_участия)

**НАРУШЕНИЕ НФ:**
1НФ

**ПРИЧИНА:**
У сотрудника может быть несколько проектов и ролей

**ПОЯСНЕНИЕ:**
Сотрудник может участвовать в разных проектах и в каждом — в разной роли. Списки проектов/ролей в одной записи нарушают атомарность 1НФ.

**НОРМАЛИЗАЦИЯ:**
- Сотрудники (ID_сотрудника, ФИО_сотрудника, Должность)
- Проекты (ID_проекта, Название_проекта, Описание)
- Виды_участия (ID_вида, Название_вида)
- Участие (ID_сотрудника, ID_проекта, ID_вида, Дата_начала, Дата_окончания)
  PRIMARY KEY (ID_сотрудника, ID_проекта, ID_вида)
